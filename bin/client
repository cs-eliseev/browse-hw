#!/usr/bin/env php
<?php

require_once __DIR__ . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR . 'vendor' . DIRECTORY_SEPARATOR . 'autoload.php';

use browse\socket\SocketClient;

$params = getopt('', ['host::', 'port::', 'message::']);

$host = $params['address'] ?? '127.0.0.1';
$port = $params['port'] ?? 5030;

$msg = $params['message'] ?? 'Hello';

try {
    $client = new SocketClient($host, $port);
    $client->sender($msg);

    echo $client->getResult() . PHP_EOL;

} catch (Throwable $e) {
    echo 'Exception: ' . $e->getMessage() . PHP_EOL;
} finally {
    unset($client);
}